{% load wagtailcore_tags wagtailimages_tags stuff %}
<div class="{% if self.white_background %}bg-white{% endif %} relative w-full overflow-hidden">

  <div class="relative max-w-screen-lg mx-auto md:px-4 my-16 xl:my-20 z-10">
    {% if self.heading %}
      <h2 id="{{ self.heading|slugify }}" class="text-2xl md:text-3xl max-w-2xl mx-auto mb-10 lg:my-24 text-green-500 font-bold text-center js-animate-in" data-animation="zoomIn">
        {% highlight self.heading self.highlight_in_heading "text-purple" %}
      </h2>
    {% endif %}

    <div class="flex flex-wrap items-stretch justify-center xl:-mx-6">
      {% for card in self.cards %}
        
        <a href="{{ card.url }}" class="group mb-8 md:mx-4 lg:mx-10 flex md:flex-col w-full sm:w-64 js-animate-in" data-animation="zoomIn">
          <div class="flex-shrink-0 overflow-hidden h-32 w-40 md:h-40 md:w-full bg-gray-200 mr-5">
            <picture>
              {% image card.image fill-512x320 format-webp as image_webp %}
              {% image card.image fill-512x320 as image %}
              <source srcset="{{ image_webp.url }}" type="image/webp">
              <img {{ image.attrs }} loading="lazy" class="h-full w-full object-cover md:transition-transform md:duration-200 md:transform md:group-hover:scale-105">
            </picture>
          </div>

          <div>
            <h3 class="inline-block text-base md:text-xl md:mt-5 mb-2 font-bold text-brown group-hover:text-green-600">{{ card.heading }}</h3>
            <p class="text-sm font-light leading-snug md:leading-normal my-3">{{ card.text|truncatechars:100 }}</p>
            {% if card.button_text %}
              <div class="md:hidden my-3 text-sm inline-flex items-center h-9 pt-px px-5 rounded-full bg-white text-green-600 border border-green-600 group-hover:bg-green-500 group-hover:text-white group-hover:font-bold">
                {{ card.button_text }}
              </div>
            {% endif %}
          </div>

          {% if card.button_text %}
            <div class="hidden md:block md:mt-auto">
              <div class="my-3 text-sm inline-flex items-center h-9 pt-px px-5 rounded-full bg-white text-green-600 border border-green-600 group-hover:bg-green-500 group-hover:text-white group-hover:font-bold">
                {{ card.button_text }}
              </div>
            </div>
          {% endif %}
        </a>

      {% endfor %}
    </div>
  </div>
</div>