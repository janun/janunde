{% load wagtailcore_tags nettes_datum srcset wagtailimages_tags stuff %}

<div class="card click-area card--color-{{ object.color }}"
     itemscope itemtype="http://schema.org/Event">

  <a class="click-area__area-link" href="{% pageurl object %}" itemprop="url">
    {{ object.title }}
  </a>

  {% if object.main_image %}
    {% image object.main_image fill-300x113 as image %}
    <img class="card__image"
         srcset="{{ object.main_image|srcset:'fill-300x113 fill-600x226 fill-900x339 fill-1200x452' }}"
         sizes="18.75em"
         src="{{ image.url }}" alt="image.alt">
    {% image object.main_image original as orig_image %}
    <link itemprop="image" href="{{ orig_image.url }}">
  {% else %}
    <div class="card__image-placeholder"></div>
  {% endif %}

  <div class="card__overlay">
    <meta itemprop="startDate" content="{{ object.start|date:"c" }}">
    <meta itemprop="endDate" content="{{ object.end|date:"c" }}">

    <!-- TODO: better dateformat -->
    {{ object.start|date:"d.m." }}
    {% if object.end %}
      bis {{ object.end|date:"d.m." }}
    {% endif %}

    {% if object.facebook_object_url %}
      <a class="card__overlay-link icon-social-facebook" title="Facebook-Event"
         target="_blank" itemprop="sameAs"
         href="{{ object.facebook_object_url }}"></a>
    {% endif %}

    {% if object.website_url %}
      <a class="card__overlay-link icon-direction" title="externe Website"
         target="_blank" itemprop="sameAs"
         href="{{ object.website_url }}"></a>
    {% endif %}
  </div>

  <div class="card__content card__content-short">
    <h2 class="card__title" itemprop="name">{{ object.hyphenated_title|safe }}</h2>
    {% if object.location %}
      <span class="card__text"><i class="icon-location-pin"></i> {{ object.location }}</span>
    {% endif %}
  </div>

  {% if object.related_group %}
    {% include "core/_card_related_group.html" with related_group=object.related_group %}
  {% endif %}

  {% if object.location %}
    <span itemprop="location" itemscope itemtype="http://schema.org/Place">
      <meta itemprop="name" content="{{ object.location }}">
      <meta itemprop="address" content="{{ object.location }}">
    </span>
  {% endif %}


</div>
